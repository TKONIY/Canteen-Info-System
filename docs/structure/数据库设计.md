# 数据库设计
## 1 mongodb简介
数据库有三层  
第一层: **db**(database)，我们只用一个database  
第二层: **collection**，每个db里面有很多collection  
第三层: **document**，每个collection里面有很多document  

## 2 设计
* 以下是三个 collection 中的document格式设计。  

`comment` : 用户评论

```json
{
    _id:      String型，表示该评论的id（可能用不到）,
    _openid:  String型，表示评论用户的id,
    time:     Date型，表示用户发表评论的时间,
    stall:    String型，所评价菜品所在的窗口,
    dish:     String型，菜品名,
    score:    Number型，菜品得分,
    content:  String型，评论内容,
    likes:    Number型，点赞数,
    likeuser: Array型，点赞用户,
    picture:  Array型，图片路径的数组
}

Eg:
{
    "_id": "swjck787Dcnjixciuv",
    "_openid": "dsjKjdoihco879c8vcxv7c8",
    "time": Date("2019-2-1"),
    "stall": "教四烤鱼饭",
    "dish": "麻辣烤鱼饭",
    "score": 4,
    "content": "不够辣",
    "likes": 3,
    "likeuser": [
        "437cx7z9vcHAjca8c9",
        "dsjKjdoihco879c8vcxv7c8",
        "dsajiojc8796cvGusidh"
    ],
    picture: [
        "图一路径",
        "图二路径",
        "图三路径"
    ]
}
```

`canteen` ：每一层食堂的总体信息

```json
{
    "name": String型，饭堂名称,
    "people": Number型，当前人数,
    "grade": String型，拥挤程度
},

Eg:
{
    "name": "学一",
    "people": 75,
    "grade": "较拥挤"
},
```

`stall` ：每个窗口总体信息

```json
{
    "name": String型，窗口名称,
    "canteen": String型，窗口所属饭堂,
    "menu": Array型，菜品名,
    "score": Number型,
    "info": String型，窗口简介,
    "picture": String型，表示图片路径
}

Eg:
{
    "name": "学五木桶饭",
    "canteen": "学五",
    "menu": [
        "回锅肉木桶饭",
        "辣子鸡木桶饭"
    ],
    "score": 4.5,
    "info": "沙邮唯一的木桶饭，等待时间较长",
    "picture": "图片路径"
}
```

`dish` : 菜品信息

```json
{
    "name": String型，菜品名称,
    "stall": String型，窗口名称,
    "price": Number型，菜品价格,
   	"dishscore": Number型，菜品评分,
    "pic": String型，菜品图片路径
}

Eg:
{
    "name": "回锅肉木桶饭",
    "stall": "学五木桶饭",
    "price": 16,
    "dishscore": 3.8,
    "pic": "路径1"
},
{
    "name": "辣子鸡木桶饭",
    "stall": "学五木桶饭",
    "price": 15,
    "dishscore": 4.2,
    "pic": "路径2"
}
```
